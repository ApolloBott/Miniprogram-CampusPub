<view class="text-to-image-page data-v-3f3b62ce"><canvas style="width:750px;height:1000px;position:fixed;left:-9999px;" id="textCanvas" type="2d" class="data-v-3f3b62ce"></canvas><view class="image-preview-container data-v-3f3b62ce"><block wx:if="{{isGenerating}}"><view class="loading-container data-v-3f3b62ce"><view class="loading-spinner data-v-3f3b62ce"></view><text class="loading-text data-v-3f3b62ce">正在生成图片...</text></view></block><block wx:else><block wx:if="{{tempImagePath}}"><view class="preview-image-wrapper data-v-3f3b62ce"><image class="preview-image data-v-3f3b62ce" id="previewImage" src="{{tempImagePath}}" mode="widthFix"></image></view></block><block wx:else><view class="empty-preview data-v-3f3b62ce"><text class="empty-icon data-v-3f3b62ce">🎨</text><text class="empty-text data-v-3f3b62ce">选择背景图片生成预览</text><text class="empty-hint data-v-3f3b62ce">向下滑动选择背景风格</text></view></block></block></view><block wx:if="{{$root.g0}}"><view class="highlight-toolbar-container data-v-3f3b62ce"><view class="button-group data-v-3f3b62ce"><view data-event-opts="{{[['tap',[['showHighlightPrompt',['$event']]]]]}}" class="highlight-action-btn add-more data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">继续添加</text></view><view data-event-opts="{{[['tap',[['clearHighlight',['$event']]]]]}}" class="highlight-action-btn clear data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">清除</text></view></view></view></block><block wx:if="{{tempImagePath&&!isGenerating}}"><view class="font-slider-container data-v-3f3b62ce"><text class="slider-label data-v-3f3b62ce">字号:</text><slider class="font-slider data-v-3f3b62ce" value="{{currentFontSize}}" min="{{minFontSize}}" max="{{initialFontSize}}" block-size="20" activeColor="#C00000" backgroundColor="#f0f0f0" data-event-opts="{{[['changing',[['handleSliderChange',['$event']]]]]}}" bindchanging="__e"></slider><block wx:if="{{$root.g1>1}}"><view data-event-opts="{{[['tap',[['openSelector',['font']]]]]}}" class="font-change-button data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">换字体</text></view></block><view data-event-opts="{{[['tap',[['openTextEditor',['$event']]]]]}}" class="font-change-button edit-btn data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">改文案</text></view></view></block><view class="bg-selector-section data-v-3f3b62ce"><text class="selector-title data-v-3f3b62ce">选择背景风格</text><scroll-view class="bg-image-list data-v-3f3b62ce" scroll-x="{{true}}" show-scrollbar="false"><block wx:for="{{$root.l0}}" wx:for-item="bg" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['handleSelectCategory',[index]]]]]}}" class="{{['bg-image-item','data-v-3f3b62ce',(selectedCategoryIndex===index)?'active':'',(isGenerating)?'disabled':'']}}" bindtap="__e"><image class="bg-thumbnail data-v-3f3b62ce" src="{{bg.$orig.currentStyle.path}}" mode="aspectFill"></image><view class="bg-name-wrapper data-v-3f3b62ce"><text class="bg-name data-v-3f3b62ce">{{bg.$orig.name}}</text></view><block wx:if="{{selectedCategoryIndex===index}}"><view class="selected-badge data-v-3f3b62ce"><text class="badge-icon data-v-3f3b62ce">✓</text></view></block><block wx:if="{{bg.g2}}"><view data-event-opts="{{[['tap',[['openSelector',['style']]]]]}}" class="change-style-btn data-v-3f3b62ce" catchtap="__e"><text class="change-icon data-v-3f3b62ce">⋮</text></view></block></view></block></scroll-view></view><view class="bottom-actions data-v-3f3b62ce"><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="action-btn cancel data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">取消</text></view><block wx:if="{{tempImagePath&&!isGenerating}}"><view data-event-opts="{{[['tap',[['showHighlightPrompt',['$event']]]]]}}" class="action-btn drawing-toggle data-v-3f3b62ce" bindtap="__e"><text class="data-v-3f3b62ce">{{$root.g3>0?'继续添加':'高亮'}}</text></view></block><view data-event-opts="{{[['tap',[['confirmSelection',['$event']]]]]}}" class="{{['action-btn','confirm','data-v-3f3b62ce',(!tempImagePath||isGenerating||isUploading)?'disabled':'']}}" bindtap="__e"><text class="data-v-3f3b62ce">{{isUploading?'上传中...':isGenerating?'生成中...':'下一步'}}</text></view></view><block wx:if="{{showTextEditor}}"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="text-editor-modal data-v-3f3b62ce" catchtap="__e"><view data-event-opts="{{[['tap',[['closeTextEditor',['$event']]]]]}}" class="modal-mask data-v-3f3b62ce" bindtap="__e"></view><view class="modal-content data-v-3f3b62ce"><view class="modal-header data-v-3f3b62ce"><text class="modal-title data-v-3f3b62ce">编辑文案</text><view data-event-opts="{{[['tap',[['closeTextEditor',['$event']]]]]}}" class="close-btn data-v-3f3b62ce" bindtap="__e">×</view></view><view class="textarea-wrapper data-v-3f3b62ce"><textarea class="editor-textarea data-v-3f3b62ce" maxlength="500" placeholder="请输入文字内容..." show-confirm-bar="{{false}}" fixed="true" cursor-spacing="100" data-event-opts="{{[['input',[['__set_model',['','editingText','$event',[]]]]]]}}" value="{{editingText}}" bindinput="__e"></textarea><text class="char-count data-v-3f3b62ce">{{$root.g4+"/500"}}</text></view><view class="modal-footer data-v-3f3b62ce"><view data-event-opts="{{[['tap',[['closeTextEditor',['$event']]]]]}}" class="modal-btn cancel data-v-3f3b62ce" bindtap="__e">取消</view><view data-event-opts="{{[['tap',[['confirmTextEdit',['$event']]]]]}}" class="modal-btn confirm data-v-3f3b62ce" bindtap="__e">确认生成</view></view></view></view></block><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="{{['selector-drawer','data-v-3f3b62ce',(showSelector)?'visible':'']}}" catchtap="__e"><view data-event-opts="{{[['tap',[['closeSelector',['$event']]]]]}}" class="drawer-mask data-v-3f3b62ce" bindtap="__e"></view><view class="drawer-content data-v-3f3b62ce"><view class="drawer-header data-v-3f3b62ce"><text class="drawer-title data-v-3f3b62ce">{{''+(selectorType==='font'?'选择字体':'选择背景样式')+''}}</text><view data-event-opts="{{[['tap',[['closeSelector',['$event']]]]]}}" class="drawer-close data-v-3f3b62ce" bindtap="__e">×</view></view><scroll-view class="drawer-scroll data-v-3f3b62ce" scroll-y="{{true}}"><view class="drawer-grid data-v-3f3b62ce"><block wx:if="{{selectorType==='font'}}"><block class="data-v-3f3b62ce"><block wx:for="{{currentFontList}}" wx:for-item="font" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['handleOptionSelect',[index]]]]]}}" class="{{['drawer-item','font-item','data-v-3f3b62ce',(currentFontIndex===index)?'active':'']}}" bindtap="__e"><text class="font-name data-v-3f3b62ce">{{font.name}}</text><text class="font-preview data-v-3f3b62ce" style="{{'font-family:'+(font.family||'sans-serif')+';'}}">人生没有白走的路</text><block wx:if="{{currentFontIndex===index}}"><view class="check-mark data-v-3f3b62ce">✓</view></block></view></block></block></block><block wx:if="{{selectorType==='style'}}"><block class="data-v-3f3b62ce"><block wx:for="{{currentCategoryStyles}}" wx:for-item="style" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['handleOptionSelect',[index]]]]]}}" class="{{['drawer-item','style-item','data-v-3f3b62ce',(currentStyleIndex===index)?'active':'']}}" bindtap="__e"><image class="style-thumb data-v-3f3b62ce" src="{{style.path}}" mode="aspectFill"></image><text class="style-name data-v-3f3b62ce">{{style.name||'样式 '+(index+1)}}</text><block wx:if="{{currentStyleIndex===index}}"><view class="check-mark data-v-3f3b62ce">✓</view></block></view></block></block></block></view></scroll-view></view></view></view>