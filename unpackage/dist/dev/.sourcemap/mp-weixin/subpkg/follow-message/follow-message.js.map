{"version":3,"sources":["uni-app:///main.js","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?0b43","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?bf67","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?bffc","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?d585","uni-app:///subpkg/follow-message/follow-message.vue","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?9bc6","webpack:///D:/HBuilderX.4.76.2025082103/HBuilderX/project/shopping/subpkg/follow-message/follow-message.vue?c9d8"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","followerList","loading","followLoading","publisher_info","onLoad","computed","methods","getFollowerList","uni","code","res","followingIds","console","follower","is_mutual_follow","title","icon","goToProfile","queryObj","payload","url","handleFollow","publisher_id","index","following_ids"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,sBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2H;AAC3H;AACkE;AACL;AACc;;;AAG3E;AACyJ;AACzJ,gBAAgB,mKAAU;AAC1B,EAAE,oFAAM;AACR,EAAE,yFAAM;AACR,EAAE,kGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,6FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAyjB,CAAgB,skBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACsD7kB;AAAA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MAAA;MACAC;IACA;EACA;EAEAC;IACA;EACA;EAEAC,4BACA,uEACA;EAEAC,yCACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAAA;gBAAA;gBAAA,OAGAC;kBACAC;gBACA;cAAA;gBAFAC;gBAIA;kBACA;kBACAC;kBACAC;;kBAEA;kBACA;oBACA;oBACA;oBAEA,uCACAC;sBACAC;oBAAA;kBAEA;;kBAEAF;gBACA;kBACAJ;oBACAO;oBACAC;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAJ;gBACAJ;kBACAO;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAC;kBAAAT;gBAAA;gBAAA;gBAAA,OACAD;cAAA;gBAAA;gBAAAE;gBACA;kBACA;gBACA;gBACAS;gBAAA;gBAAA,OAEAX;kBACAY;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAR;gBACAJ;kBACAO;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAK;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAEAD;gBAAA;gBAAA;gBAAA,OAIAZ;kBACAC;kBACAa;gBACA;cAAA;gBAHAZ;gBAKA;kBACA;kBACAG;;kBAEA;kBACAF;kBAEA;oBACA;oBACA;sBACAA;oBACA;kBACA;oBACA;oBACAY;oBACA;sBACAZ;oBACA;kBACA;;kBAEA;kBACA,sDACA;oBACAa;kBAAA,GACA;kBAEAZ;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACAJ;kBACAO;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EAAA;AAEA;AAAA,2B;;;;;;;;;;;;;ACjMA;AAAA;AAAA;AAAA;AAA4jC,CAAgB,6gCAAG,EAAC,C;;;;;;;;;;;ACAhlC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"subpkg/follow-message/follow-message.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg/follow-message/follow-message.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./follow-message.vue?vue&type=template&id=116eac4c&\"\nvar renderjs\nimport script from \"./follow-message.vue?vue&type=script&lang=js&\"\nexport * from \"./follow-message.vue?vue&type=script&lang=js&\"\nimport style0 from \"./follow-message.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg/follow-message/follow-message.vue\"\nexport default component.exports","export * from \"-!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./follow-message.vue?vue&type=template&id=116eac4c&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.followerList.length === 0 && !_vm.loading\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./follow-message.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./follow-message.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"follow-message-container\">\n\n    <!-- 粉丝列表 -->\n    <view class=\"follower-list\">\n      <view \n        v-for=\"follower in followerList\" \n        :key=\"follower.id\" \n        class=\"follower-item\"\n      >\n        <!-- 左侧：头像和信息 -->\n        <view class=\"follower-info\" @click=\"goToProfile(follower)\">\n          <image \n            :src=\"follower.follower_avatarUrl\" \n            class=\"avatar\"\n            mode=\"aspectFill\"\n          ></image>\n          \n          <view class=\"info-content\">\n            <text class=\"nickname\">{{ follower.follower_nickname }}</text>\n            <view class=\"follow-info\">\n              <text class=\"follow-time\">{{ follower.follow_time }}</text>\n              <text class=\"follow-tip\">关注了你</text>\n            </view>\n          </view>\n        </view>\n\n        <!-- 右侧:关注按钮 -->\n        <view class=\"follow-btn-wrapper\">\n          <button \n            :class=\"['follow-btn', follower.is_mutual_follow ? 'mutual' : 'normal']\"\n            @click=\"handleFollow(follower)\"\n            :disabled=\"followLoading === follower.follower_openid\"\n          >\n            {{ follower.is_mutual_follow ? '互相关注' : '+ 关注' }}\n          </button>\n        </view>\n      </view>\n\n      <!-- 空状态 -->\n      <view v-if=\"followerList.length === 0 && !loading\" class=\"empty-state\">\n        <!-- <image src=\"/static/empty-follower.png\" class=\"empty-image\"></image> -->\n        <text class=\"empty-text\">暂无粉丝</text>\n      </view>\n\n      <!-- 加载状态 -->\n      <view v-if=\"loading\" class=\"loading-state\">\n        <text>加载中...</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { mapState, mapMutations } from 'vuex'\nexport default {\n  data() {\n    return {\n      followerList: [],\n      loading: false,\n      followLoading: null, // 当前正在关注的用户openid\n\t  publisher_info: {},\n    };\n  },\n  \n  onLoad() {\n    this.getFollowerList();\n  },\n\n  computed: {\n    ...mapState('m_user', ['token', 'code', 'userBase', 'openid']),\n  },\n  \n  methods: {\n    ...mapMutations('m_user', ['updateUserInfo', 'updateToken', 'updateUserBase', 'updateCode', 'updateOpenid']),\n    \n    // 获取粉丝列表\n    async getFollowerList() {\n      this.loading = true;\n      \n      try {\n        const res = await uni.$http.get('/users/follow-message', {\n          code: this.openid\n        });\n          \n        if (res.data.meta.status === 200) {\n          // 获取当前用户的关注列表\n          const followingIds = this.userBase?.following_ids || [];\n          console.log('当前用户关注列表:', followingIds);\n          \n          // 处理粉丝列表数据,判断是否互相关注\n          this.followerList = res.data.data.map(follower => {\n            // 判断该粉丝的 openid 是否在当前用户的关注列表中\n            const isMutualFollow = followingIds.includes(follower.follower_openid);\n            \n            return {\n              ...follower,\n              is_mutual_follow: isMutualFollow // 根据本地数据判断是否互相关注\n            };\n          });\n          \n          console.log('处理后的粉丝列表:', this.followerList);\n        } else {\n          uni.showToast({\n            title: res.data.message || '获取失败',\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        console.error('获取粉丝列表失败:', error);\n        uni.showToast({\n          title: '网络错误',\n          icon: 'none'\n        });\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    // 跳转到用户主页\n    async goToProfile(follower) {\n      try {\n\t\tconst queryObj = {code: follower.follower_openid};\n        const { data: res } = await uni.$http.get('/users/userinfo', queryObj);\n        if (res.meta.status === 200) {\n\t\t\tthis.publisher_info = res.message\n        }\n        const payload = encodeURIComponent(JSON.stringify(this.publisher_info));\n        \n        await uni.navigateTo({\n          url: `/subpkg/profile/profile?publisher=${payload}`\n        });\n      } catch (error) {\n        console.error('跳转失败:', error);\n        uni.showToast({\n          title: '页面跳转失败',\n          icon: 'none'\n        });\n      }\n    },\n\n    // 处理关注/取消关注\n    async handleFollow(follower) {\n      this.followLoading = follower.follower_openid;\n      \n      const url = follower.is_mutual_follow ? '/users/unfollow' : '/users/follow';\n      \n      try {\n        // 调用关注/取消关注接口\n        const res = await uni.$http.post(url, {\n          code: this.openid,\n          publisher_id: follower.follower_openid\n        });\n\n        if (res.data.meta.status === 200) {\n          // 更新本地状态\n          follower.is_mutual_follow = !follower.is_mutual_follow;\n          \n          // 同步更新 userBase.following_ids\n          const followingIds = this.userBase?.following_ids || [];\n          \n          if (follower.is_mutual_follow) {\n            // 关注成功,添加到关注列表\n            if (!followingIds.includes(follower.follower_openid)) {\n              followingIds.unshift(follower.follower_openid);\n            }\n          } else {\n            // 取消关注,从关注列表移除\n            const index = followingIds.indexOf(follower.follower_openid);\n            if (index > -1) {\n              followingIds.splice(index, 1);\n            }\n          }\n          \n          // 更新 Vuex 中的 userBase\n          this.updateUserBase({\n            ...this.userBase,\n            following_ids: followingIds\n          });\n          \n          console.log('更新后的关注列表:', followingIds);\n        }\n      } catch (error) {\n        console.error('操作失败:', error);\n        uni.showToast({\n          title: '网络错误',\n          icon: 'none'\n        });\n      } finally {\n        this.followLoading = null;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.follow-message-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding: 20rpx;\n}\n\n.header {\n  background-color: #fff;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n  border-radius: 16rpx;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  \n  .title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #333;\n  }\n  \n  .count {\n    font-size: 28rpx;\n    color: #999;\n  }\n}\n\n.follower-list {\n  .follower-item {\n    background-color: #fff;\n    padding: 30rpx;\n    margin-bottom: 20rpx;\n    border-radius: 16rpx;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    \n    .follower-info {\n      display: flex;\n      align-items: center;\n      flex: 1;\n      cursor: pointer;\n      \n      .avatar {\n        width: 100rpx;\n        height: 100rpx;\n        border-radius: 50%;\n        margin-right: 24rpx;\n      }\n      \n      .info-content {\n        display: flex;\n        flex-direction: column;\n        \n        .nickname {\n          font-size: 32rpx;\n          color: #333;\n          font-weight: 500;\n          margin-bottom: 12rpx;\n        }\n        \n        .follow-info {\n          display: flex;\n          align-items: center;\n          \n          .follow-time {\n            font-size: 24rpx;\n            color: #999;\n            margin-right: 12rpx;\n          }\n          \n          .follow-tip {\n            font-size: 24rpx;\n            color: #666;\n          }\n        }\n      }\n    }\n    \n    .follow-btn-wrapper {\n      .follow-btn {\n        padding: 16rpx 40rpx;\n        border-radius: 50rpx;\n        font-size: 28rpx;\n        border: none;\n        \n        &.normal {\n          background-color: #1890ff;\n          color: #fff;\n        }\n        \n        &.mutual {\n          background-color: #f0f0f0;\n          color: #999;\n        }\n      }\n    }\n  }\n}\n\n.empty-state {\n  text-align: center;\n  padding: 100rpx 0;\n  \n  .empty-image {\n    width: 300rpx;\n    height: 300rpx;\n    margin-bottom: 40rpx;\n  }\n  \n  .empty-text {\n    font-size: 28rpx;\n    color: #999;\n  }\n}\n\n.loading-state {\n  text-align: center;\n  padding: 100rpx 0;\n  font-size: 28rpx;\n  color: #999;\n}\n</style>\n","import mod from \"-!../../../../plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./follow-message.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./follow-message.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1763783747809\n      var cssReload = require(\"D:/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}